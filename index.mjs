// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-positive-integer@esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-square-matrix@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-vector-like@esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/array-float64@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-sqrt@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-ctor@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-ctor@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-numel@esm/index.mjs";var d=e.isPrimitive,l=r,h=t,f=s,u=n,p=i,g=a,c=o,j=m;function v(e,r){return(r?c:g)("float64",new f(e*e),[e,e],[e,1],0,"row-major")}function w(e){var r;return r=new f(e),c("float64",r,[e],[1],0,"row-major")}var b=function(e,r){var t,s,n,i,a,o,m,g;if(g=0,d(e))s=v(t=e,!1);else{if(!l(e))throw new TypeError(u("invalid argument. First argument must either specify the order of the correlation distance matrix or be a square two-dimensional ndarray for storing the correlation distance matrix. Value: `%s`.",e));t=e.shape[0],s=e}if(m=new f(t),n=new f(t),i=new f(t),o=v(t,!0),arguments.length>1){if(!h(r))throw new TypeError(u("invalid argument. Second argument must be a one-dimensional ndarray. Value: `%s`.",r));if(j(r.shape)!==t)throw new Error(u("invalid argument. The number of elements (means) in the second argument must match correlation distance matrix dimensions. Expected: `%u`. Actual: `%u`.",t,j(r.shape)));return a=r,b}return a=w(t),c;function c(e){var r,d,l,f,c,j,v,w,b,x,y,E;if(0===arguments.length)return 0===g?null:s;if(!h(e))throw new TypeError(u("invalid argument. Must provide a one-dimensional ndarray. Value: `%s`.",e));if(e.shape[0]!==t)throw new Error(u("0eiAH",t,e.shape[0]));if(x=(b=g)/(g+=1),r=b||1,1===g)for(y=0;y<t;y++)for(v=e.get(y),w=a.get(y),w+=(j=v-w)/g,a.set(y,w),m[y]=j,n[y]+=j*(v-w),i[y]=p(n[y]/r),d=x*m[y],E=0;E<=y;E++)l=o.get(y,E)+d*m[E],o.set(y,E,l),o.set(E,y,l);else for(y=0;y<t;y++)for(v=e.get(y),w=a.get(y),w+=(j=v-w)/g,a.set(y,w),m[y]=j,n[y]+=j*(v-w),i[y]=p(n[y]/r),d=x*m[y],c=i[y],E=0;E<y;E++)l=o.get(y,E)+d*m[E],o.set(y,E,l),o.set(E,y,l),f=1-l/r/(c*i[E]),s.set(y,E,f),s.set(E,y,f);return s}function b(e){var r,d,l,f,c,j;if(0===arguments.length)return 0===g?null:s;if(!h(e))throw new TypeError(u("invalid argument. Must provide a one-dimensional ndarray. Value: `%s`.",e));if(e.shape[0]!==t)throw new Error(u("0eiAI",t,e.shape[0]));for(g+=1,c=0;c<t;c++)for(f=e.get(c)-a.get(c),m[c]=f,n[c]+=f*f,i[c]=p(n[c]/g),l=i[c],j=0;j<c;j++)d=o.get(c,j)+f*m[j],o.set(c,j,d),o.set(j,c,d),r=1-d/g/(l*i[j]),s.set(c,j,r),s.set(j,c,r);return s}};export{b as default};
//# sourceMappingURL=index.mjs.map

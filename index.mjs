// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-positive-integer@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-square-matrix@esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-vector-like@esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/array-float64@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/string-format@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-sqrt@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-ctor@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-ctor@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-numel@esm/index.mjs";var d=e.isPrimitive,l=t,u=r,h=s,c=n,f=i,p=a,g=o,j=m;function v(e,t){return(t?g:p)("float64",new h(e*e),[e,e],[e,1],0,"row-major")}function w(e){var t;return t=new h(e),g("float64",t,[e],[1],0,"row-major")}var x=function(e,t){var r,s,n,i,a,o,m,p;if(p=0,d(e))s=v(r=e,!1);else{if(!l(e))throw new TypeError(c("invalid argument. First argument must either specify the order of the correlation distance matrix or be a square 2-dimensional ndarray for storing the correlation distance matrix. Value: `%s`.",e));r=e.shape[0],s=e}if(m=new h(r),n=new h(r),i=new h(r),o=v(r,!0),arguments.length>1){if(!u(t))throw new TypeError(c("invalid argument. Second argument must be a 1-dimensional ndarray. Value: `%s`.",t));if(j(t.shape)!==r)throw new Error(c("invalid argument. The number of elements (means) in the second argument must match correlation distance matrix dimensions. Expected: %u. Actual: %u.",r,j(t.shape)));return a=t,x}return a=w(r),g;function g(e){var t,d,l,h,g,j,v,w,x,b,y,E;if(0===arguments.length)return 0===p?null:s;if(!u(e))throw new TypeError(c("invalid argument. Must provide a 1-dimensional ndarray. Value: `%s`.",e));if(e.shape[0]!==r)throw new Error(c("invalid argument. Vector length must match correlation matrix dimensions. Expected: `%u`. Actual: `%u`.",r,e.shape[0]));if(b=(x=p)/(p+=1),t=x||1,1===p)for(y=0;y<r;y++)for(v=e.get(y),w=a.get(y),w+=(j=v-w)/p,a.set(y,w),m[y]=j,n[y]+=j*(v-w),i[y]=f(n[y]/t),d=b*m[y],E=0;E<=y;E++)l=o.get(y,E)+d*m[E],o.set(y,E,l),o.set(E,y,l);else for(y=0;y<r;y++)for(v=e.get(y),w=a.get(y),w+=(j=v-w)/p,a.set(y,w),m[y]=j,n[y]+=j*(v-w),i[y]=f(n[y]/t),d=b*m[y],g=i[y],E=0;E<y;E++)l=o.get(y,E)+d*m[E],o.set(y,E,l),o.set(E,y,l),h=1-l/t/(g*i[E]),s.set(y,E,h),s.set(E,y,h);return s}function x(e){var t,d,l,h,g,j;if(0===arguments.length)return 0===p?null:s;if(!u(e))throw new TypeError(c("invalid argument. Must provide a 1-dimensional ndarray. Value: `%s`.",e));if(e.shape[0]!==r)throw new Error(c("invalid argument. Vector length must match correlation distance matrix dimensions. Expected: `%u`. Actual: `%u`.",r,e.shape[0]));for(p+=1,g=0;g<r;g++)for(h=e.get(g)-a.get(g),m[g]=h,n[g]+=h*h,i[g]=f(n[g]/p),l=i[g],j=0;j<g;j++)d=o.get(g,j)+h*m[j],o.set(g,j,d),o.set(j,g,d),t=1-d/p/(l*i[j]),s.set(g,j,t),s.set(j,g,t);return s}};export{x as default};
//# sourceMappingURL=index.mjs.map
